(this.webpackJsonpsqllineagejs=this.webpackJsonpsqllineagejs||[]).push([[0],{465:function(e,t,n){},741:function(e,t,n){"use strict";n.r(t);var a,r=n(42),i=n(7),c=n.n(i),o=n(89),s=n.n(o),l=(n(465),n(36)),d=n(22),u=n(803),j=n(763),b=n(804),h=n(761),O=n(801),f=n(808),g=n(809),p=n(802),x=n(805),m=n(427),y=n.n(m),v=n(428),w=n.n(v),S=n(358),C=n.n(S),E=n(150),T=n(12),N=n.n(T),k=n(232),I=n(211),L=n(192),_=n(334);function R(e){var t=new URL(window.location.href),n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_PORT,a=n?t.origin.replace(t.port,n):t.origin;return"".concat(a).concat(e)}function D(e){return H.apply(this,arguments)}function H(){return(H=Object(k.a)(N.a.mark((function e(t){var n,a,r,i,c,o,s,l=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},a=n.body,r=Object(_.a)(n,["body"]),i={"Content-Type":"application/json"},c=Object(L.a)(Object(L.a)({method:a?"POST":"GET"},r),{},{headers:Object(L.a)(Object(L.a)({},i),r.headers)}),a&&(c.body=JSON.stringify(a)),e.prev=4,e.next=7,window.fetch(t,c);case 7:return s=e.sent,e.next=10,s.json();case 10:if(o=e.sent,!s.ok){e.next=13;break}return e.abrupt("return",o);case 13:throw new Error(s.statusText);case 16:return e.prev=16,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0.message?e.t0.message:o));case 19:case"end":return e.stop()}}),e,null,[[4,16]])})))).apply(this,arguments)}D.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return D(e,Object(L.a)(Object(L.a)({},t),{},{method:"GET"}))},D.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return D(e,Object(L.a)(Object(L.a)({},n),{},{body:t}))};var z=Object(I.b)("editor/fetchContent",function(){var e=Object(k.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.post(R("/script"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),A=Object(I.b)("dag/fetchDAG",function(){var e=Object(k.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.post(R("/lineage"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),P=Object(I.c)({name:"editor",initialState:{file:"",content:"",contentComposed:"",editable:!1,editorStatus:"idle",editorError:null,dagContent:[],dagVerbose:"",dagStatus:"idle",dagError:null},reducers:{setContentComposed:function(e,t){e.contentComposed=t.payload},setEditable:function(e,t){e.editable=t.payload},setFile:function(e,t){e.file=t.payload}},extraReducers:(a={},Object(l.a)(a,z.pending,(function(e){e.editorStatus="loading"})),Object(l.a)(a,z.fulfilled,(function(e,t){e.editorStatus="succeeded",e.content=t.payload.content})),Object(l.a)(a,z.rejected,(function(e,t){e.editorStatus="failed",e.editorError=t.error.message})),Object(l.a)(a,A.pending,(function(e){e.dagStatus="loading"})),Object(l.a)(a,A.fulfilled,(function(e,t){e.dagStatus="succeeded",e.dagContent=t.payload.dag,e.dagVerbose=t.payload.verbose})),Object(l.a)(a,A.rejected,(function(e,t){e.dagStatus="failed",e.dagError=t.error.message})),a)}),V=function(e){return e.editor},B=P.actions,F=B.setContentComposed,W=B.setEditable,G=B.setFile,M=P.reducer,q=n(790),U=n(791);function K(e){return Object(r.jsx)(u.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(r.jsx)(q.a,{in:!0,style:{transitionDelay:"500ms"},unmountOnExit:!0,children:Object(r.jsx)(U.a,{})})})}var Q=n(433),Z=n.n(Q);function J(e){return Object(r.jsx)(u.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(r.jsxs)("span",{children:[Object(r.jsx)(Z.a,{color:"primary",fontSize:"large"}),Object(r.jsx)("p",{children:e.message})]})})}var Y=n(810),X=n(811),$=n(793),ee=n(794),te=n(435),ne=n.n(te),ae=n(436),re=n.n(ae),ie=n(437),ce=n.n(ie),oe=n(438),se=n.n(oe);C.a.use(w.a);var le=Object($.a)((function(e){return{speedDial:{position:"absolute","&.MuiSpeedDial-directionLeft":{bottom:e.spacing(12),right:e.spacing(2)}}}}));function de(e){var t=le(),n=Object(E.c)(V),a=c.a.useState(!1),o=Object(d.a)(a,2),s=o[0],l=o[1],u=Object(i.useRef)(null);if("loading"===n.dagStatus)return Object(r.jsx)(K,{minHeight:e.height});if("failed"===n.dagStatus)return Object(r.jsx)(J,{minHeight:e.height,message:n.dagError});var j={width:e.width,height:e.height};return Object(r.jsxs)("div",{children:[Object(r.jsx)(y.a,{elements:n.dagContent,stylesheet:[{selector:"node",style:{height:10,width:10,content:"data(id)","text-valign":"top","text-halign":"right","font-size":10,color:"#35393e","background-color":"#3499d9","border-color":"#000","border-width":1,"border-opacity":.8}},{selector:"edge",style:{width:1,"line-color":"#9ab5c7","target-arrow-color":"#9ab5c7","target-arrow-shape":"triangle","arrow-scale":.8,"curve-style":"bezier"}}],style:j,layout:{name:"dagre",rankDir:"LR",rankSep:200},zoom:1,minZoom:.5,maxZoom:2,wheelSensitivity:.2,ref:u}),Object(r.jsxs)(Y.a,{ariaLabel:"SpeedDial example",className:t.speedDial,hidden:!1,icon:Object(r.jsx)(X.a,{}),onClose:function(){return l(!1)},onOpen:function(){return l(!0)},open:s,direction:"left",FabProps:{size:"small"},children:[Object(r.jsx)(ee.a,{title:"Save",icon:Object(r.jsx)(ne.a,{}),onClick:function(){if(u.current){var e=u.current._cy,t=document.createElement("a");t.download="".concat(n.file,".jpg"),t.href=e.jpg({full:!0,quality:1}),t.click(),l(!1)}}}),Object(r.jsx)(ee.a,{title:"Zoom In",icon:Object(r.jsx)(re.a,{}),onClick:function(){u.current._cy.zoom(u.current._cy.zoom()+.1)}}),Object(r.jsx)(ee.a,{title:"Auto Fit",icon:Object(r.jsx)(ce.a,{}),onClick:function(){u.current._cy.fit()}}),Object(r.jsx)(ee.a,{title:"Zoom Out",icon:Object(r.jsx)(se.a,{}),onClick:function(){u.current._cy.zoom(u.current._cy.zoom()-.1)}})]})]})}var ue=n(332),je=n(110);function be(e){var t=Object(E.b)(),n=Object(E.c)(V),a=new URLSearchParams(Object(je.e)().search),c=Object(je.d)();Object(i.useEffect)((function(){var e=a.get("e");if(null!==e)t(F(e)),c.push("/");else{var r=a.get("f");n.file!==r&&(t(G(r)),null===r?(t(W(!0)),t(A({e:n.contentComposed}))):(t(W(!1)),t(z({f:r})),t(A({f:r}))))}}));if("loading"===n.editorStatus)return Object(r.jsx)(K,{minHeight:e.height});if("failed"===n.editorStatus)return Object(r.jsx)(J,{minHeight:e.height,message:n.editorError});var o={minimap:{enabled:!1},readOnly:!n.editable,wordWrap:"on",automaticLayout:!0};return Object(r.jsx)(ue.a,{width:e.width,height:e.height,language:"sql",value:n.editable?n.contentComposed:n.content,options:o,editorDidMount:function(e,n){e.onDidBlurEditorText((function(){e.getOption(75)||(t(F(e.getValue())),t(A({e:e.getValue()})))}))}})}var he,Oe=n(798),fe=n(799),ge=n(800),pe=n(444),xe=n.n(pe),me=n(445),ye=n.n(me),ve=n(760),we=n(443),Se=n.n(we),Ce=n(45),Ee=n(797),Te=n(441),Ne=n.n(Te),ke=n(442),Ie=n.n(ke),Le=n(807),_e=n(243),Re=Object(I.b)("directory/fetchDirectory",Object(k.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URL(window.location.href),e.next=3,D.post(R("/directory"),Object.fromEntries(t.searchParams));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))),De=Object(I.c)({name:"directory",initialState:{content:{},status:"idle",error:null},reducers:{},extraReducers:(he={},Object(l.a)(he,Re.pending,(function(e){e.status="loading"})),Object(l.a)(he,Re.fulfilled,(function(e,t){e.status="succeeded",e.content=t.payload})),Object(l.a)(he,Re.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),he)}),He=function(e){return e.directory},ze=De.reducer,Ae=Object(_e.a)((function(e){return e.directory.content}),(function(e){var t=new Set;return function e(n){Array.isArray(n.children)?n.children.map((function(t){return e(t)})):t.add(n.id)}(e),t})),Pe=n(439),Ve=n.n(Pe),Be=n(440),Fe=n.n(Be),We=n(806),Ge=Object($.a)((function(e){return{directory:{marginLeft:e.spacing(.2)},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.1,0)},labelIcon:{marginRight:e.spacing(.2)},labelText:{fontWeight:"inherit",flexGrow:1}}}));function Me(e){var t=Ge(),n=e.labelText,a=e.labelIcon,i=Object(_.a)(e,["labelText","labelIcon"]);return Object(r.jsx)(Le.a,Object(L.a)({label:Object(r.jsxs)("div",{className:t.labelRoot,children:[Object(r.jsx)(a,{color:"action",className:t.labelIcon}),Object(r.jsx)(ve.a,{variant:"body2",className:t.labelText,children:n})]})},i))}function qe(e){var t=Ge(),n=Object(E.b)(),a=Object(E.c)(He),o=Object(je.d)(),s=c.a.useState(!1),l=Object(d.a)(s,2),u=l[0],j=l[1],b=Object(E.c)(Ae);Object(i.useEffect)((function(){"idle"===a.status&&n(Re())}));return"loading"===a.status?Object(r.jsx)(K,{minHeight:e.height}):"failed"===a.status?Object(r.jsx)(J,{minHeight:e.height,message:a.error}):Object(r.jsxs)("div",{children:[Object(r.jsx)(Ee.a,{className:t.directory,defaultCollapseIcon:Object(r.jsx)(Ne.a,{}),defaultExpanded:["root"],defaultExpandIcon:Object(r.jsx)(Ie.a,{}),onNodeSelect:function(e,t){b.has(t)&&(t.endsWith(".sql")?o.push("/?f=".concat(t)):j(!0))},children:function e(t){return Object(r.jsx)(Me,{nodeId:t.id,labelText:t.name,labelIcon:Array.isArray(t.children)?Ve.a:Fe.a,children:Array.isArray(t.children)?t.children.map((function(t){return e(t)})):null},t.id)}(a.content)}),Object(r.jsx)(We.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:u,autoHideDuration:1e3,onClose:function(){j(!1)},message:"Non SQL File Is Not Supported"})]})}var Ue=n(273);function Ke(e){var t=Object(E.c)(V);if("loading"===t.dagStatus)return Object(r.jsx)(K,{minHeight:e.height});if("failed"===t.dagStatus)return Object(r.jsx)(J,{minHeight:e.height,message:t.dagError});return Object(r.jsx)(ue.a,{width:e.width,height:e.height,value:t.dagVerbose,options:{minimap:{enabled:!1},readOnly:!0,wordWrap:"on",automaticLayout:!0}})}var Qe="18vw",Ze=Object($.a)((function(e){return{appBar:{flexGrow:1,zIndex:e.zIndex.drawer+1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},content:{padding:e.spacing(.5),marginTop:e.spacing(6),float:"right"},hide:{display:"none"},drawerPaper:{width:Qe},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})}}}));function Je(){var e=Ze(),t=Object(E.c)(V),n=c.a.useState("dag"),a=Object(d.a)(n,2),o=a[0],s=a[1],m=c.a.useState(!1),y=Object(d.a)(m,2),v=y[0],w=y[1],S="85vh",C="99.5vw",T=Object(i.useMemo)((function(){return v?C.slice(0,-2)-Qe.slice(0,-2)+"vw":C}),[v]);return Object(r.jsx)(Ue.a,{children:Object(r.jsxs)("div",{children:[Object(r.jsxs)(u.a,{children:[Object(r.jsx)(Oe.a,{position:"fixed",className:e.appBar,children:Object(r.jsxs)(fe.a,{variant:"dense",children:[Object(r.jsx)(ge.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",onClick:function(){w(!v)},children:v?Object(r.jsx)(Se.a,{}):Object(r.jsx)(xe.a,{})}),Object(r.jsx)(ve.a,{variant:"h6",className:e.title,children:"SQLLineage"}),t.editable?Object(r.jsx)(j.a,{title:"Visualize Lineage By Filling In Your Own SQL",arrow:!0,children:Object(r.jsx)("div",{children:"Composing Mode"})}):Object(r.jsx)(Ue.b,{to:"/",style:{color:"white"},children:Object(r.jsx)(j.a,{title:"Enter Composing Mode to Visualize Your Own SQL",arrow:!0,children:Object(r.jsx)(ge.a,{color:"inherit",onClick:function(){s("script"),w(!1)},children:Object(r.jsx)(ye.a,{})})})})]})}),Object(r.jsx)(b.a,{variant:"persistent",open:v,classes:{paper:e.drawerPaper},children:Object(r.jsx)(u.a,{className:e.content,children:Object(r.jsx)(qe,{})})})]}),Object(r.jsxs)("main",{className:Object(Ce.a)(e.content,Object(l.a)({},e.contentShift,v)),children:[Object(r.jsxs)(h.a,{elevation:"24",style:{height:S,width:T},children:[Object(r.jsx)(u.a,{className:"dag"===o?"":e.hide,children:Object(r.jsx)(de,{height:S,width:T})}),Object(r.jsx)(u.a,{className:"text"===o?"":e.hide,children:Object(r.jsx)(Ke,{height:S,width:T})}),Object(r.jsx)(u.a,{className:"script"===o?"":e.hide,children:Object(r.jsx)(be,{height:S,width:T})})]}),Object(r.jsx)(O.a,{container:!0,justify:"center",children:Object(r.jsx)(f.a,{component:"fieldset",children:Object(r.jsxs)(g.a,{row:!0,"aria-label":"position",name:"position",defaultValue:"dag",value:o,onChange:function(e){return s(e.target.value)},children:[Object(r.jsx)(p.a,{value:"dag",control:Object(r.jsx)(x.a,{color:"primary"}),label:"Lineage View"}),Object(r.jsx)(p.a,{value:"text",control:Object(r.jsx)(x.a,{color:"primary"}),label:"Text View"}),Object(r.jsx)(p.a,{value:"script",control:Object(r.jsx)(x.a,{color:"primary"}),label:"Script View"})]})})})]})]})})}var Ye=Object(I.a)({reducer:{directory:ze,editor:M}});s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(E.a,{store:Ye,children:Object(r.jsx)(Je,{})})}),document.getElementById("root"))}},[[741,1,2]]]);
//# sourceMappingURL=main.7e37cbce.chunk.js.map