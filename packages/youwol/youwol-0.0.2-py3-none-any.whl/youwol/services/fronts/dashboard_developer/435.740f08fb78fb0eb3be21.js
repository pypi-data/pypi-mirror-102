(self.webpackChunk=self.webpackChunk||[]).push([[435],{435:(e,t,a)=>{"use strict";a.r(t);var s=a(222),n=a(690),r=a(905);function i(e,t=(e=>e)){return new r.Observable((a=>{fetch(e).then((e=>e.json())).then((e=>{a.next(t(e)),a.complete()})).catch((e=>a.error(e)))}))}class c{static connectWs(){return c.webSocket$||(c.webSocket$=new r.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/frontends/ws`).onmessage=e=>{c.webSocket$.next(JSON.parse(e.data))}),c.webSocket$}static status$(){let e=`${c.urlBase}/status`;return i(new Request(e,{method:"GET",headers:f.headers}))}static start$(e){let t=`${c.urlBase}/${e}/start`;return i(new Request(t,{method:"POST",headers:f.headers}))}static stop$(e){let t=`${c.urlBase}/${e}/stop`;return i(new Request(t,{method:"POST",headers:f.headers}))}static skeletons$(){let e=`${c.urlBase}/skeletons`;return i(new Request(e,{method:"GET",headers:f.headers}))}static createSkeleton$(e,t){let a=`${c.urlBase}/skeletons/${e}`;return i(new Request(a,{method:"POST",body:JSON.stringify(t),headers:f.headers}))}}c.urlBase="/admin/frontends";class l{static connectWs(){return l.webSocket$||(l.webSocket$=new r.ReplaySubject,new WebSocket(`ws://${window.location.host}${l.urlBase}/ws`).onmessage=e=>{l.webSocket$.next(JSON.parse(e.data))}),l.webSocket$}static status$(){let e=`${l.urlBase}/status`;return i(new Request(e,{method:"GET",headers:f.headers}))}static start$(e){let t=e?`${l.urlBase}/${e}/start`:`${l.urlBase}/start`;return i(new Request(t,{method:"POST",headers:f.headers}))}static restart$(){let e=`${l.urlBase}/restart`;return i(new Request(e,{method:"POST",headers:f.headers}))}static stop$(e){let t=`${l.urlBase}/${e}/stop`;return i(new Request(t,{method:"POST",headers:f.headers}))}static skeletons$(){let e=`${l.urlBase}/skeletons`;return i(new Request(e,{method:"GET",headers:f.headers}))}static createSkeleton$(e,t){let a=`${l.urlBase}/skeletons/${e}`;return i(new Request(a,{method:"POST",body:JSON.stringify(t),headers:f.headers}))}static install$(e){let t=`${l.urlBase}/${e}/install`;return i(new Request(t,{method:"POST",headers:f.headers}))}}l.urlBase="/admin/backends";class o{static connectWs(){return o.webSocket$||(o.webSocket$=new r.ReplaySubject,new WebSocket(`ws://${window.location.host}${o.urlBase}/ws`).onmessage=e=>{o.webSocket$.next(JSON.parse(e.data))}),o.webSocket$}static status$(){let e=`${o.urlBase}/status`;return i(new Request(e,{method:"GET",headers:f.headers}))}static action$(e){let t=`${o.urlBase}/action`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}static dependencies$(e){let t=`${o.urlBase}/${e}/dependencies`;return i(new Request(t,{method:"GET",headers:f.headers}))}static watch$(e){let t=`${o.urlBase}/watch`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}static skeletons$(){let e=`${o.urlBase}/skeletons`;return i(new Request(e,{method:"GET",headers:f.headers}))}static createSkeleton$(e,t){let a=`${o.urlBase}/skeletons/${e}`;return i(new Request(a,{method:"POST",body:JSON.stringify(t),headers:f.headers}))}static install$(e){let t=`${o.urlBase}/${e}/install`;return i(new Request(t,{method:"POST",headers:f.headers}))}}o.urlBase="/admin/packages";class u{static connectWs(){return u.webSocket$||(u.webSocket$=new r.ReplaySubject,new WebSocket(`ws://${window.location.host}${u.urlBase}/ws`).onmessage=e=>{u.webSocket$.next(JSON.parse(e.data))}),u.webSocket$}static status$(){let e=`${u.urlBase}/status`;return i(new Request(e,{method:"GET",headers:f.headers}))}static fileContent$(){let e=`${u.urlBase}/file-content`;return i(new Request(e,{method:"GET",headers:f.headers}))}static switchConfiguration$(e){let t=`${u.urlBase}/switch-configuration`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}static syncUser$(e){let t=`${u.urlBase}/sync-user`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}static login$(e){let t=`${u.urlBase}/login`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}static postConfigParameters$(e){let t=`${u.urlBase}/configuration/parameters`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}}u.urlBase="/admin/environment";class d{static status$(){let e=`${d.urlBase}/status`;return i(new Request(e,{method:"GET",headers:f.headers}))}static path$(e){let t=`${d.urlBase}/${e}/path`;return i(new Request(t,{method:"GET",headers:f.headers}))}static publishLibraryVersion$(e,t){let a=`${d.urlBase}/${e}/${t}`;return i(new Request(a,{method:"POST",headers:f.headers}))}static syncPackage$(e){let t=`${d.urlBase}/${e}`;return i(new Request(t,{method:"POST",headers:f.headers}))}static syncPackages$(e){let t=`${d.urlBase}`;return i(new Request(t,{method:"POST",body:JSON.stringify(e),headers:f.headers}))}}d.urlBase="/admin/assets/packages";class h{static connectWs(){return h.webSocket$||(h.webSocket$=new r.ReplaySubject,new WebSocket(`ws://${window.location.host}${h.urlBase}/ws`).onmessage=e=>{h.webSocket$.next(JSON.parse(e.data))}),h.webSocket$}}h.urlBase="/admin/assets",h.packages=d;class f{static setHeaders(e){f.headers=e}}f.urlBase="/admin",f.headers={},f.fronts=c,f.backs=l,f.modules=o,f.environment=u,f.assets=h;var p=a(519),g=a(327);let b="p-2 fv-text-primary h-100 d-flex flex-column h-100";function m(e,t){return new g.Button.View({contentView:()=>({children:[{tag:"i",class:e},{tag:"span",class:"px-2",innerText:t}]}),class:"fv-btn fv-btn-secondary mx-2"})}function w(e,t=!1){let a=new r.BehaviorSubject(t);return{class:"d-flex align-items-top fv-bg-background-alt border rounded ",style:{"font-style":"oblique",width:"fit-content"},children:[{tag:"i",class:(0,s.attr$)(a,(e=>e?"fv-hover-text-primary fv-text-focus":"fv-hover-text-focus fv-text-primary "),{wrapper:e=>e+" fas py-2 px-3 fa-info fv-pointer fv-hover-text-focus "}),onclick:e=>{a.next(!a.getValue()),e.stopPropagation()}},{class:(0,s.attr$)(a,(e=>e?"py-3 pl-1 pr-3":"")),children:[(0,s.child$)(a,(t=>t?e:{}))]}]}}var x,$,v,S,T,k,y,N,E,R=a(888);!function(e){e.INSTALL="INSTALL",e.BUILD="BUILD",e.TEST="TEST",e.CDN="CDN",e.SYNC="SYNC",e.SERVE="SERVE"}(x||(x={})),function(e){e.TARGET_ONLY="TARGET_ONLY",e.ALL_ABOVE="ALL_ABOVE",e.ALL_BELOW="ALL_BELOW",e.ALL="ALL"}($||($={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(v||(v={})),function(e){e.STARTED="STARTED",e.PREPARATION="PREPARATION",e.STATUS="STATUS",e.RUNNING="RUNNING",e.PACKAGING="PACKAGING",e.DONE="DONE"}(S||(S={})),function(e){e.INSTALLED="INSTALLED",e.NOT_INSTALLED="NOT_INSTALLED"}(T||(T={})),function(e){e.SYNC="SYNC",e.RED="RED",e.NEVER_BUILT="NEVER_BUILT",e.OUT_OF_DATE="OUT_OF_DATE",e.INDIRECT_OUT_OF_DATE="INDIRECT_OUT_OF_DATE"}(k||(k={})),function(e){e.GREEN="GREEN",e.OUT_OF_DATE="OUT_OF_DATE",e.INDIRECT_OUT_OF_DATE="OUT_OF_DATE",e.RED="RED",e.NO_ENTRY="NO_ENTRY"}(y||(y={})),function(e){e.SYNC="SYNC",e.NOT_PUBLISHED="NOT_PUBLISHED",e.OUT_OF_DATE="OUT_OF_DATE",e.CDN_ERROR="CDN_ERROR"}(N||(N={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(E||(E={}));class O{constructor({action:e,step:t,target:a,content:s,level:n,json:r,contextId:i}){this.contextId=void 0,this.children=[],this.action=e,this.step=t,this.target=a,this.content=s,this.level=n,this.json=r,this.contextId=i}}class I{constructor(e){this.logs$=e,this.ongoingTasks$={}}}class C extends R.ImmutableTree.Node{constructor({name:e,data:t}){super({id:`${Math.floor(1e6*Math.random())}`,children:C.getChildren(t)}),this.name=e,this.data=t}static getChildren(e){return null!=e&&null!=e&&"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e?(0,r.of)(Object.entries(e).map((([e,t])=>new C({name:e,data:t})))):void 0}}let L={[S.STATUS]:"fas fa-info",[S.STARTED]:"fas fa-play",[S.PREPARATION]:"fas fa-running",[S.RUNNING]:"fas fa-running",[S.PACKAGING]:"fas fa-archive",[S.DONE]:"far fa-flag"};class P{constructor(e){this.state=e,this.class="h-25 d-flex flex-column",this.children=[this.header(),this.content()]}header(){return{tag:"hr",class:"fv-color-primary w-100"}}content(){return{class:" fv-bg-background-alt flex-grow-1 overflow-auto ",children:(0,s.children$)(this.state.logs$.pipe((0,p.map)((e=>new O(e))),(0,p.filter)((e=>e.level!=E.DEBUG&&null!=e.step)),(0,p.scan)(((e,t)=>[t,...e.slice(0,99)]),[])),(e=>this.view(e)))}}view(e){return e.map((e=>this.messageView(e)))}messageView(e){let t=e.json?this.jsonView(e.json):{};return{class:"d-flex align-items-center my-1 "+(e.level==E.ERROR?"fv-text-error fv-bg-on-error":"fv-text-primary"),children:[{class:"px-1 "+L[e.step],tag:"i"},{class:"px-2",tag:"i",innerText:e.action},,{class:"px-2",tag:"i",innerText:e.target},{class:"px-2 d-flex align-items-center",children:[{class:"mx-2",innerHTML:e.content},t]}]}}jsonView(e){let t=new C({name:"data",data:e}),a=new R.ImmutableTree.State({rootNode:t});return new R.ImmutableTree.View({state:a,headerView:(e,t)=>{let a={innerText:t.name};return t.children?a:{class:"d-flex align-items-baseline",children:[a,{tag:"i",class:"px-2",innerText:t.data}]}}})}}var A=a(337),B=a(313);class D extends B.Select.ItemData{constructor(e){super(e.name,e.name),this.data=e}}function V(e,t,a){let n=t.map((e=>new D(e))),i=new B.Select.State(n,n[0].id),c=new A.Modal.State,l=m("","Create"),o=new r.ReplaySubject(1),u=new A.Modal.View({state:c,contentView:()=>({class:"fv-text-primary fv-bg-background-alt p-4 rounded border fv-color-primary",style:{"max-width":"75%"},children:[{class:"d-flex align-items-baseline py-2 text-center mx-auto justify-content-center",children:[{tag:"h3",class:"text-center fv-text-focus",innerText:e},new B.Select.View({state:i,class:"mx-2",style:{"font-size":"x-large"}})]},(0,s.child$)(i.selection$,(e=>function(e,t){let a=e.data.parameters.map((e=>{let t=new r.ReplaySubject(1);return null!=e.defaultValue&&t.next({id:e.id,value:e.defaultValue}),t}));return{children:[(n=e.data.description,{children:[{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle fa-2x px-3"},{tag:"div",innerHTML:n}]},{tag:"hr",class:"fv-color-primary"}]}),{children:e.data.parameters.map(((e,t)=>function(e,t){let a=new r.BehaviorSubject(!1),n={string:{class:"ml-2",tag:"input",placeholder:e.placeholder,oninput:a=>t.next({id:e.id,value:a.target.value})},text:{tag:"textarea",class:"ml-2 w-100 flex-grow-1",placeholder:e.placeholder,oninput:a=>t.next({id:e.id,value:a.target.value})}};return{children:[{class:"d-flex align-items-center my-3",children:[{class:e.required?"fv-text-focus":"",innerText:e.displayName},{class:"fv-text-focus",innerText:e.required?"*":""},{class:(0,s.attr$)(a,(e=>e?"fv-text-focus":""),{wrapper:e=>"i fas fa-info fv-pointer mx-2 fv-hover-text-focus "+e}),onclick:()=>a.next(!a.getValue())},{...n[e.type],...e.defaultValue?{value:e.defaultValue}:{}}]},{class:(0,s.attr$)(a,(e=>e?"d-block":"d-none")),innerText:e.description}]}}(e,a[t])))}],connectedCallback:e=>{0!=a.length?e.subscriptions.push((0,r.combineLatest)(a).pipe((0,p.map)((e=>e.reduce(((e,t)=>({...e,[t.id]:t.value})),{})))).subscribe((e=>{t.next(e)}))):t.next({parameters:{}})}};var n}(e,o))),{tag:"hr",class:"fv-color-primary"},(0,s.child$)(o,(e=>l))]})}),d=(0,s.render)(u);document.body.appendChild(d),c.cancel$.subscribe((()=>d.remove())),l.state.click$.pipe((0,p.mergeMap)((()=>o)),(0,p.mergeMap)((e=>a.createSkeleton$(i.selectionId$.getValue(),{parameters:e})))).subscribe((e=>{d.remove()}))}function _(e,t){let a=new r.BehaviorSubject(!1),n=m("fas fa-plus","pick file");return n.state.click$.subscribe((()=>a.next(!a.getValue()))),{class:"flex-grow-1",children:[{class:"d-flex align-items-center",children:[{class:"p-2",style:{"font-size":"x-large"},innerText:"configuration:"},(0,s.child$)((0,r.combineLatest)([e,t,a]),(([e,t,s])=>s?function(e){return{tag:"input",class:"flex-grow-1",type:"text",placeholder:"Enter the full local path of the file and press 'enter'",onkeypress:t=>{"Enter"==t.key&&(q.switchConfiguration(t.target.value),t.target.onblur=()=>{},e.next(!1))},onblur:t=>e.next(!1)}}(a):function(e,t){let a=t.map((e=>new B.Select.ItemData(e,e))),s=new B.Select.State(a,e.configurationPath);return s.selection$.pipe((0,p.skip)(1)).subscribe((e=>{q.switchConfiguration(e.id)})),new B.Select.View({state:s})}(e,t))),(0,s.child$)(a,(e=>e?{}:n))]}]}}class U extends A.ExpandableGroup.State{constructor(e){super("User info"),this.environment$=e}}function G(e){return{className:A.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,s.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-users"},{innerText:"User info",class:"px-2",style:{"font-size":"large"}},{class:"fv-text-focus px-2",children:[{innerText:(0,s.attr$)(e.environment$,(e=>`Logged as ${e.userInfo.name}`))}]}]}}function F(e){let t=e.pipe((0,p.map)((e=>e.users.map((e=>new B.Select.ItemData(e,e)))))),a=new r.BehaviorSubject("anonymous");e.subscribe((e=>{a.next(e.userInfo.name)}));let n=new B.Select.State(t,a);n.selectionId$.pipe((0,p.skip)(1),(0,p.distinctUntilChanged)(),(0,p.mergeMap)((e=>f.environment.login$({email:e})))).subscribe((()=>{}));let i=m("fas fa-plus","sync. user");return i.state.click$.subscribe((()=>function(){let e=new A.Modal.State,t=m("","Sign-in"),a=new r.Subject,n=new r.Subject,i=new A.Modal.View({state:e,contentView:()=>({class:"fv-text-primary fv-bg-background-alt p-4 rounded border fv-color-primary",style:{"max-width":"500px"},children:[{class:"d-flex align-items-baseline py-2 text-center mx-auto justify-content-center",children:[{tag:"h4",class:"text-center fv-text-focus",innerText:"Synchronize with remote user"}]},{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle fa-2x px-3"},{tag:"div",innerHTML:"Provide the email adress and password of the user for which you want to synchronize the profile.  Please make sure your internet connection is turned on."}]},{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-baseline w-100",children:[{tag:"i",class:"fas fa-at px-3"},{tag:"input",type:"text",class:"flex-grow-1",onchange:e=>a.next(e.target.value)}]},{class:"d-flex align-items-baseline w-100 my-2",children:[{tag:"i",class:"fas fa-key px-3"},{tag:"input",type:"password",class:"flex-grow-1",onchange:e=>n.next(e.target.value)}]},{class:"pt-3",children:[t]}]})}),c=(0,s.render)(i);document.body.appendChild(c),e.cancel$.subscribe((()=>c.remove())),t.state.click$.pipe((0,p.withLatestFrom)((0,r.combineLatest)([a,n])),(0,p.mergeMap)((([e,[t,a]])=>f.environment.syncUser$({email:t,password:a,remoteEnvironment:"dev.platform.youwol.com"})))).subscribe((e=>{console.log(e),c.remove()}))}())),new A.ExpandableGroup.View({state:new U(e),headerView:G,contentView:e=>({class:"border rounded fv-color-primary p-2",children:[w({tag:"ul",innerText:"To better work with local YouWol it is preferable to sync your user info with your remotes account.\n                It is required when:\n                ",children:[{tag:"li",innerText:"When pushing or pulling data"}]}),{class:"d-flex align-items-center",children:[{innerText:"Current user:"},new B.Select.View({state:n,class:"mx-2"}),i]},{children:[(0,s.child$)(e.environment$,(e=>({tag:"ul",innerText:"Member of:",children:e.userInfo.memberOf.map((e=>({tag:"li",class:"",innerText:e})))})))]}]}),className:"my-2"})}class M extends A.ExpandableGroup.State{constructor(e){super("User info"),this.environment$=e}}function j(e){return{className:A.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,s.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-cog"},{innerText:"Configuration parameters",class:"px-2",style:{"font-size":"large"}}]}}class q{constructor(){q.webSocket$.pipe((0,p.take)(1),(0,p.mergeMap)((()=>f.environment.status$()))).subscribe((e=>q.cacheConfigurationPath(e.configurationPath)))}static switchConfiguration(e){f.environment.switchConfiguration$({path:e}).subscribe()}static getCachedConfigurationPaths(){return JSON.parse(localStorage.getItem("youwol-local-dashboard")||"{}").configurationPaths||[]}static cacheConfigurationPath(e){let t=q.getCachedConfigurationPaths();if(t.includes(e))return;t=t.filter((t=>t!=e)).concat([e]);let a={configurationPaths:t};localStorage.setItem("youwol-local-dashboard",JSON.stringify(a)),q.configurationPaths$.next(t)}}q.webSocket$=f.environment.connectWs(),q.environment$=q.webSocket$.pipe((0,p.filter)((e=>"Environment"==e.type))),q.loadingStatus$=q.webSocket$.pipe((0,p.filter)((e=>"LoadingStatus"==e.type))),q.configurationUpdated$=q.webSocket$.pipe((0,p.filter)((e=>"ConfigurationUpdated"==e.type))),q.configurationPaths$=new r.BehaviorSubject(q.getCachedConfigurationPaths());class W{constructor(e){this.tag="div",this.class=b,this.state=e;let t=new I(q.webSocket$.pipe((0,p.map)((e=>e))));var a;this.children=[{class:"flex-grow-1",children:[_(q.environment$,q.configurationPaths$),(a=q.environment$,new A.ExpandableGroup.View({state:new M(a),headerView:j,contentView:e=>({class:"border rounded fv-color-primary p-2",children:[w({innerText:"These parameters are those declared in your configuration file. They can control behaviors of the different pipelines.\n                Refer to the configuration file for more information on the meaning of these parameters.\n                "}),(0,s.child$)(a,(e=>{return t=e.configurationParameters.parameters,{class:"my-2",children:Object.entries(t).map((([e,t])=>{let a={};return"ENUM"==t.meta.type&&(a=function(e,t){let a=t.meta.values.map((e=>new B.Select.ItemData(e,e))),s=new B.Select.State(a,t.value);return s.selectionId$.pipe((0,p.filter)((e=>e!=t.value)),(0,p.mergeMap)((t=>f.environment.postConfigParameters$({values:{[e]:t}})))).subscribe((()=>{})),new B.Select.View({state:s})}(e,t)),{class:"border rounded p-2",children:[{class:"d-flex align-items-center",children:[{class:"px-2 fv-text-focus",innerText:t.name+":"},a]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle px-3"},{innerText:t.description}]}]}}))};var t}))]}),className:"my-2"})),F(q.environment$)]},new P(t)],this.connectedCallback=e=>{e.subscriptions.push()}}}class Y{constructor(){this.status$=new r.ReplaySubject(1),this.webSocket$=f.fronts.connectWs(),this.webSocket$.pipe((0,p.filter)((({type:e})=>"Status"==e))).subscribe((({status:e})=>{this.status$.next(e)})),(0,r.combineLatest)([this.webSocket$.pipe((0,p.take)(1)),q.configurationUpdated$]).pipe((0,p.mergeMap)((()=>f.fronts.status$()))).subscribe((e=>{this.status$.next(e.status)}))}}class H{constructor(e){this.tag="div",this.class=b,this.state=e;let t=new I(this.state.webSocket$);this.children=[{tag:"h3",class:"d-flex",children:[(0,s.child$)(e.status$,(()=>({children:[this.newFrontBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,s.child$)(e.status$,(e=>this.contentView(e))),new P(t)],this.connectedCallback=e=>{}}newFrontBttn(){let e=m("fas fa-plus","new front-end");return e.state.click$.pipe((0,p.mergeMap)((()=>f.fronts.skeletons$()))).subscribe((({skeletons:e})=>{V("New frontend",e,f.fronts)})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.tableView(e)]}}tableView(e){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"url"},{tag:"td",innerText:"Dev server"},{tag:"td",innerText:"Health"}]}]},{tag:"tbody",children:e.map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt",children:[(t=e,{tag:"td",innerText:t.name,style:{"font-family":"cursive","font-size":"large"}}),z(e),Q(this.state,e),J(e)]};var t}))}]}}}function z(e){return{tag:"td",children:[{tag:"a",href:e.url,innerText:e.url}]}}function J(e){return{tag:"td",class:e?"fv-text-success":"fv-text-error",children:[{tag:"i",class:e?"fas fa-check px-2":"fas fa-times px-2",onclick}]}}function Q(e,t){if(null==t.devServer)return{};let a=e.webSocket$.pipe((0,p.filter)((e=>e.target==t.name&&e.action==x.SERVE)),(0,p.filter)((({step:e})=>[S.STARTED,S.DONE].includes(e)))),n=new r.ReplaySubject;return a.subscribe((e=>{n.next(e)})),n.next(t.devServer?{step:S.STARTED}:{step:S.DONE}),{tag:"td",children:[{children:[(0,s.child$)(n,(({step:e})=>({tag:"i",class:"fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus"+(e==S.STARTED?" fas fa-stop ":" fas fa-play "),onclick:()=>e==S.STARTED?f.fronts.stop$(t.name).subscribe((()=>{})):f.fronts.start$(t.name).subscribe((()=>{}))})))]}]}}class K{constructor(){this.status$=new r.ReplaySubject(1),this.highlighted$=new r.ReplaySubject(1),this.autoWatched$=new r.BehaviorSubject([]),this.dependenciesRequest$=new r.Subject,this.webSocket$=f.modules.connectWs(),(0,r.combineLatest)([this.webSocket$.pipe((0,p.take)(1)),q.configurationUpdated$]).pipe((0,p.mergeMap)((()=>f.modules.status$()))).subscribe((e=>{this.status$.next(e)})),this.dependenciesRequest$.pipe((0,p.debounceTime)(250),(0,p.switchMap)((({assetId:e,direction:t})=>f.modules.dependencies$(e).pipe((0,p.map)((e=>({deps:e,direction:t}))))))).subscribe((({deps:e,direction:t})=>{"up"==t?this.highlighted$.next(e.belowDependencies):this.highlighted$.next(e.aboveDependencies)}))}toggleWatch(e){let t=this.autoWatched$.getValue();t=t.includes(e)?t.filter((t=>t!=e)):t.concat([e]),this.autoWatched$.next(t),f.modules.watch$({libraries:t}).subscribe()}}class X{constructor(e){this.tag="div",this.class=b,this.state=e;let t=new I(this.state.webSocket$.pipe((0,p.map)((e=>e))));this.children=[{tag:"h3",class:"d-flex",children:[(0,s.child$)(this.state.status$,(()=>({children:[this.syncAllBttn(),this.newPackageBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,s.child$)(e.status$.pipe((0,p.map)((e=>e.status))),(e=>this.contentView(e))),new P(t)],this.connectedCallback=e=>{e.subscriptions.push()}}syncAllBttn(){let e=m("fas fa-sync","Sync. all");return e.state.click$.pipe((0,p.mergeMap)((()=>f.modules.action$({action:"SYNC",targetName:"",scope:"ALL"})))).subscribe((e=>{this.state.status$.next(e)})),e}newPackageBttn(){let e=m("fas fa-plus","new package");return e.state.click$.pipe((0,p.mergeMap)((()=>f.modules.skeletons$()))).subscribe((({skeletons:e})=>{V("New package",e,f.modules)})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.installQueueView(e),this.pipelinesTableView(e)]}}installQueueView(e){return 0==e.filter((e=>"NOT_INSTALLED"==e.installStatus)).length?{}:{class:"overflow-auto",children:[{tag:"h3",innerText:"List of packages to install"},w({innerText:"Following packages have not been installed yet. \n                    Installation step usually install required dependencies and initialize the asset properly. \n                    Internet connection is usually required here."}),{tag:"table",class:"fv-color-primary mx-auto text-center my-2",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:e.filter((e=>"NOT_INSTALLED"==e.installStatus)).map((e=>({tag:"tr",children:[te(e),se(this.state,e)]})))}]}]}}pipelinesTableView(e){return e.filter((e=>"INSTALLED"==e.installStatus)),{class:"overflow-auto",children:[{tag:"h3",innerText:"Pipelines status"},{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Version"},{tag:"td",innerText:"Watch"},{tag:"td",innerText:"Actions"},{tag:"td",innerText:"Build Status"},{tag:"td",innerText:"Test Status"},{tag:"td",innerText:"CDN Status"}]}]},{tag:"tbody",children:e.filter((e=>"INSTALLED"==e.installStatus)).map((e=>({tag:"tr",class:(0,s.attr$)(this.state.highlighted$,(t=>t.includes(e.name)?"fv-bg-background-alt":""),{wrapper:e=>e+" fv-hover-bg-background-alt",untilFirst:"fv-hover-bg-background-alt"}),children:[te(e),ae(e),ne(this.state,e),re(this.state,e),le(this.state,e),oe(this.state,e),ue(this.state,e)]})))}]}]}}}let Z="fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus",ee={NEVER_BUILT:{color:"fv-text-focus ",icon:"fas fa-sync "+Z,text:"never built"},NOT_PUBLISHED:{color:"fv-text-focus ",icon:"fas fa-sync "+Z,text:""},GREEN:{color:"fv-text-success ",icon:"fas fa-check ",text:""},RED:{color:"fv-text-error ",icon:"fas fa-sync "+Z,text:""},CDN_ERROR:{color:"fv-text-error ",icon:"fas fa-times ",text:""},OUT_OF_DATE:{color:"fv-text-focus ",icon:"fas fa-sync "+Z,text:""},INDIRECT_OUT_OF_DATE:{color:"fv-text-focus ",icon:"fas fa-sync "+Z,text:"(indirect)"},NO_ENTRY:{color:"fv-text-focus ",icon:"fas fa-sync "+Z,text:""},SYNC:{color:"fv-text-success ",icon:"fas fa-check "+Z,text:""}};function te(e){return e.documentation?{tag:"td",style:{"font-family":"cursive","font-size":"large"},children:[{tag:"a",href:e.documentation,innerText:e.name}]}:{tag:"td",innerText:e.name,style:{"font-family":"cursive","font-size":"large"}}}function ae(e){return{tag:"td",innerText:e.version}}function se(e,t){let a=e.webSocket$.pipe((0,p.filter)((e=>e.target==t.name&&e.action==x.INSTALL))),n=m("","Install");return n.state.click$.pipe((0,p.mergeMap)((()=>f.modules.install$(t.assetId)))).subscribe((()=>console.log("install done"))),{class:"d-flex align-items-center",children:[(0,s.child$)(n.state.click$,(()=>({})),{untilFirst:n}),{tag:"i",class:(0,s.attr$)(a.pipe((0,p.filter)((({step:e})=>[S.STARTED,S.DONE].includes(e)))),(e=>e.step==S.STARTED?"fas fa-spinner fa-spin p-3":""))}]}}function ne(e,t){return{tag:"td",class:(0,s.attr$)(e.autoWatched$,(e=>e.includes(t.name)?"fas fa-satellite-dish fv-text-focus ":"fas fa-satellite-dish "),{wrapper:e=>e+Z}),onclick:()=>e.toggleWatch(t.name)}}function re(e,t){return{tag:"td",children:[{tag:"i",class:"far fa-arrow-alt-circle-right "+Z,onclick:()=>ie(0,{action:x.SYNC,targetName:t.name,scope:$.TARGET_ONLY})},{tag:"i",class:"far fa-arrow-alt-circle-up "+Z,onclick:()=>ie(0,{action:x.SYNC,targetName:t.name,scope:$.ALL_ABOVE}),onmouseover:()=>{e.dependenciesRequest$.next({assetId:t.assetId,direction:"up"})},onmouseout:()=>e.highlighted$.next([])},{tag:"i",class:"far fa-arrow-alt-circle-down "+Z,onclick:()=>ie(0,{action:x.SYNC,targetName:t.name,scope:$.ALL_BELOW}),onmouseover:a=>{e.dependenciesRequest$.next({assetId:t.assetId,direction:"down"})},onmouseout:()=>e.highlighted$.next([])}]}}function ie(e,t){f.modules.action$(t).subscribe((e=>{}))}function ce(e,t,a){let n=e.webSocket$.pipe((0,p.filter)((e=>e.target==t&&e.action==a))),i=new r.ReplaySubject;return{tag:"td",class:(0,s.attr$)(i,(({color:e})=>e)),children:[{tag:"i",innerText:(0,s.attr$)(i,(({text:e})=>e))},{tag:"i",class:(0,s.attr$)(i,(({icon:e})=>e)),onclick:()=>ie(0,{action:a,targetName:t,scope:$.TARGET_ONLY})},{tag:"i",class:(0,s.attr$)(n.pipe((0,p.filter)((({step:e})=>[S.STARTED,S.DONE].includes(e)))),(e=>e.step==S.STARTED?"fas fa-spinner fa-spin":""))}],connectedCallback:e=>{e.subscriptions.push(n.pipe((0,p.filter)((({step:e,content:t})=>e==S.STATUS&&null!=ee[t])),(0,p.map)((({content:e})=>ee[e]))).subscribe((e=>{i.next(e)})))}}}function le(e,t){return ce(e,t.name,x.BUILD)}function oe(e,t){return ce(e,t.name,x.TEST)}function ue(e,t){return ce(e,t.name,x.CDN)}function de(e,t,a){let n=e.pipe((0,p.filter)((e=>e.target==t.name&&e.action==x.INSTALL))),r=m("","Install");return r.state.click$.pipe((0,p.mergeMap)((()=>a.install$(t.assetId)))).subscribe((()=>console.log("install done"))),{class:"d-flex align-items-center",children:[(0,s.child$)(r.state.click$,(()=>({})),{untilFirst:r}),{tag:"i",class:(0,s.attr$)(n.pipe((0,p.filter)((({step:e})=>[S.STARTED,S.DONE].includes(e)))),(e=>e.step==S.STARTED?"fas fa-spinner fa-spin p-3":""))}]}}class he{constructor(){this.status$=new r.ReplaySubject(1),this.environments$=new r.BehaviorSubject([]),this.currentEnvironment$=new r.BehaviorSubject(""),this.selectedEnvId$=new r.BehaviorSubject(""),this.envSelectionState=new B.Select.State(this.environments$,this.selectedEnvId$),this.selectedUserId$=new r.BehaviorSubject(localStorage.getItem("user-name")||"greinisch@youwol.com"),this.subscriptions=new Array,this.webSocket$=f.backs.connectWs(),this.webSocket$.pipe((0,p.filter)((({type:e})=>"Status"==e))).subscribe((({status:e})=>{this.status$.next(e)})),(0,r.combineLatest)([this.webSocket$.pipe((0,p.take)(1)),q.configurationUpdated$]).pipe((0,p.mergeMap)((()=>f.backs.status$()))).subscribe((e=>{this.status$.next(e.status)}))}}class fe{constructor(e){this.tag="div",this.class=b,this.state=e;let t=new I(this.state.webSocket$);this.children=[{tag:"h3",class:"d-flex",children:[this.newBackBttn(),(0,s.child$)(e.status$,(()=>({children:[this.startBttn(),this.restartBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,s.child$)(e.status$,(e=>{return t=this.state.webSocket$,a=e,"",s=f.backs,0==a.filter((e=>"NOT_INSTALLED"==e.installStatus)).length?{}:{class:"overflow-auto",children:[{tag:"h4",innerText:"Assets to install"},w({innerText:""}),{tag:"table",class:"fv-color-primary mx-auto text-center my-2",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:a.filter((e=>"NOT_INSTALLED"==e.installStatus)).map((e=>({tag:"tr",children:[{tag:"td",innerText:e.name,style:{"font-family":"cursive","font-size":"large"}},de(t,e,s)]})))}]}]};var t,a,s})),(0,s.child$)(e.status$,(e=>this.contentView(e))),new P(t)],this.connectedCallback=e=>{e.subscriptions=e.subscriptions.concat(this.state.subscriptions)}}newBackBttn(){let e=m("fas fa-plus","new backend-end");return e.state.click$.pipe((0,p.mergeMap)((()=>f.backs.skeletons$()))).subscribe((({skeletons:e})=>{V("New backend",e,f.backs)})),e}startBttn(){let e=m("fas fa-play","Start");return e.state.click$.pipe((0,p.mergeMap)((()=>f.backs.start$()))).subscribe((()=>{})),e}restartBttn(){let e=m("fas fa-play","Re-start");return e.state.click$.pipe((0,p.mergeMap)((()=>f.backs.restart$()))).subscribe((()=>{})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.tableView(e)]}}tableView(e){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""},{tag:"td",innerText:"Actions"},{tag:"td",innerText:"Health"}]}]},{tag:"tbody",children:e.filter((e=>"INSTALLED"==e.installStatus)).map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt",children:[ge(this.state,e),be(this.state,e),me(this.state,e),(t=this.state,a=e,function(e,t,a){let n=e.webSocket$.pipe((0,p.filter)((e=>e.target==t.name&&"serve"==e.action)),(0,p.filter)((e=>["started","serving","done"].includes(e.step)))),i=new r.BehaviorSubject(t.health?a.serving:a.error);return{tag:"td",children:[(0,s.child$)(i,(e=>({tag:"i",class:e.class,onclick:e.onclick?e.onclick:()=>{}})))],connectedCallback:e=>{e.subscriptions.push(n.pipe((0,p.map)((e=>a[e.step]))).subscribe((e=>i.next(e))))}}}(t,a,{started:{class:"fas fa-spinner fa-spin fv-text-primary",onclick:void 0},serving:{class:"fv-text-success fas fa-check px-2",onclick:void 0},error:{class:"fv-text-error fas fa-times px-2",onclick:void 0},done:{class:"fv-text-error fas fa-times px-2",onclick:void 0}}))]};var t,a}))}]}}}let pe="fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus";function ge(e,t){return{tag:"td",innerText:t.name,style:{"font-family":"cursive","font-size":"large"}}}function be(e,t){return t.openApi?{tag:"td",innerHTML:`<a href='${t.openApi}'> doc </a> `}:{tag:"td"}}function me(e,t){return{tag:"td",children:[{tag:"i",class:t.devServer?`fas fa-stop fv-text-primary ${pe}`:`fas fa-play fv-text-primary ${pe}`,onclick:()=>{t.devServer?f.backs.stop$(t.assetId).subscribe():f.backs.start$(t.assetId).subscribe()}}]}}var we;!function(e){e.ConfigurationGeneral="conf.general",e.ConfigurationRawFile="conf.raw-file",e.LocalEnvPackage="local.packages",e.LocalEnvFronts="local.fronts",e.LocalEnvBacks="local.backs",e.AssetsUploadPackages="upload.packages",e.AssetsUploadFluxApp="upload.fluxapp",e.AssetsUploadData="upload.fluxdata"}(we||(we={}));let xe={[we.ConfigurationGeneral]:{title:"General",enabled:!0},[we.ConfigurationRawFile]:{title:"Raw file",enabled:!0},[we.LocalEnvPackage]:{title:"Packages",enabled:!0},[we.LocalEnvFronts]:{title:"Front Ends",enabled:!0},[we.LocalEnvBacks]:{title:"Back Ends",enabled:!0},[we.AssetsUploadPackages]:{title:"Packages",enabled:!0},[we.AssetsUploadFluxApp]:{title:"Flux app",enabled:!1},[we.AssetsUploadData]:{title:"Data",enabled:!1}};function $e(e,t,a,n=!0){return{class:(0,s.attr$)(a,(e=>e?"fv-text-focus":""),{wrapper:e=>e+"  d-flex align-items-center fa-2x "+(n?"fv-pointer":"")}),children:[{tag:"i",class:t+" pr-3"},{tag:"h4",innerText:e,style:{"user-select":"none"}}]}}function ve(e,t){return{tag:"ul",children:e.map((e=>function(e,t){let a=xe[e].enabled;return{tag:"li",innerText:xe[e].title,class:(0,s.attr$)(t,(t=>t==e?"fv-text-focus":a?"fv-pointer":"fv-text-background-alt")),style:{"user-select":"none"},onclick:s=>{a&&t.next(e),s.stopPropagation()}}}(e,t)))}}function Se(e,t,a,s,n=!0){return{class:"my-2 "+(n?"":"fv-text-disabled"),children:[$e(e,t,s.pipe((0,p.map)((e=>a.includes(e)))),n),ve(a,s)],onclick:()=>s.next(a[0])}}let Te={[we.LocalEnvPackage]:"Packages",[we.LocalEnvFronts]:"Front Ends",[we.LocalEnvBacks]:"Back Ends"};class ke extends n.Tabs.TabData{constructor(e){super(we.LocalEnvPackage,Te[we.LocalEnvPackage]),this.modulesState=e}view(){return new X(this.modulesState)}}class ye extends n.Tabs.TabData{constructor(e){super(we.LocalEnvFronts,Te[we.LocalEnvFronts]),this.frontEndsState=e}view(){return new H(this.frontEndsState)}}class Ne extends n.Tabs.TabData{constructor(e){super(we.LocalEnvBacks,Te[we.LocalEnvBacks]),this.backendsState=e}view(){return new fe(this.backendsState)}}class Ee{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=[new ke(e.modulesState),new ye(e.frontendsState),new Ne(e.backendsState)];this.children=[new n.Tabs.View({class:"d-flex flex-column h-100",state:new n.Tabs.State(t,e.selectedPanel$),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}var Re;!function(e){e.NOT_FOUND="PackageStatus.NOT_FOUND",e.SYNC="PackageStatus.SYNC",e.MISMATCH="PackageStatus.MISMATCH",e.PROCESSING="PackageStatus.PROCESSING"}(Re||(Re={}));let Oe={"PackageStatus.NOT_FOUND":"fv-color-error","PackageStatus.MISMATCH":"fv-color-focus","PackageStatus.SYNC":"fv-color-success","PackageStatus.PROCESSING":""},Ie={"PackageStatus.NOT_FOUND":"fas fa-times fv-text-error","PackageStatus.MISMATCH":"fas fa-exclamation fv-text-focus","PackageStatus.SYNC":"fas fa-check fv-text-success","PackageStatus.PROCESSING":"fas fa-spinner fa-spin"},Ce={"PackageStatus.NOT_FOUND":"The package has not been published yet.","PackageStatus.MISMATCH":"There is a mismatch between the published package and your local versions.\nThe published package may lack some of your local versions, or one or more version have content mismatch.","PackageStatus.SYNC":"The published package is synchronized with your local one.","PackageStatus.PROCESSING":"<i>Please wait: package is synchronizating ...</i>"};function Le(e){return{class:"d-flex justify-content-center align-items-center ",children:[{tag:"h3",class:"text-center my-2",innerText:e.libraryName},Ve(e.assetId)]}}function Pe(e){return{class:"my-4 d-flex mx-auto align-items-center  fv-bg-background-alt rounded p-3",style:{"max-width":"50%"},children:[{tag:"i",class:(0,s.attr$)(e,(({status:e})=>Ie[e]),{untilFirst:Ie["PackageStatus.PROCESSING"],wrapper:e=>e+" fa-2x"})},{class:"text-center pl-4",style:{"font-size":"large"},innerHTML:(0,s.attr$)(e,(({status:e})=>Ce[e]),{untilFirst:Ce["PackageStatus.PROCESSING"]})}]}}function Ae(e){return{class:"my-2 h-100 w-50",children:[{tag:"h5",innerText:"Local explorer references"},{children:e.treeItems.map((e=>({children:[(0,s.child$)(f.assets.packages.path$(e.itemId),(e=>function({group:e,drive:t,folders:a}){return{class:"border rounded fv-color-primary p-4",style:{width:"fit-content"},children:[{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-users px-2"},{innerText:e}]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-hdd px-2"},{innerText:t.name}]},{class:"px-2",innerText:a.reduce(((e,t)=>e+" / "+t.name),"")}]}}(e)))]})))}]}}function Be(e,t){return{class:"h-100 w-50 d-flex flex-column",style:{height:"0px"},children:[{tag:"h5",innerText:"Versions"},{class:"flex-grow-1 overflow-auto",children:[De(e,t)]}]}}function De(e,t){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Local versions"},{tag:"td",innerText:"Published versions"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:e.releases.map((a=>({tag:"tr",class:"fv-hover-bg-background-alt",children:[{tag:"td",innerText:a.version},{tag:"td",children:[{tag:"i",class:(0,s.attr$)(t.pipe((0,p.filter)((({status:e})=>[Re.NOT_FOUND,Re.MISMATCH,Re.SYNC].includes(e)))),(({status:e,details:t})=>e==Re.NOT_FOUND||e==Re.SYNC?Ie[e]:e==Re.MISMATCH&&t.missing.includes(a.version)?"fv-text-error fas fa-times":e==Re.MISMATCH&&t.sync.includes(a.version)?"fv-text-success fas fa-check":e==Re.MISMATCH&&t.mismatch.includes(a.version)?"fv-text-focus fas fa-exclamation":void 0),{untilFirst:"fas fa-spin fa-spinner",wrapper:e=>e+" px-2"})},{tag:"i",class:(0,s.attr$)(t,(({status:e,details:t})=>t&&t.version==a.version?e!=Re.PROCESSING||t.version!=a.version?"":t.version==a.version?"fas fa-spin fa-spinner":void 0:""))}]},(0,s.child$)(t,(()=>function(e,t){return{tag:"td",class:"mx-2",children:[{tag:"i",class:"fas fa-cloud-upload-alt fv-hover-text-focus p-2 fv-pointer",onclick:()=>f.assets.packages.publishLibraryVersion$(e.assetId,t).subscribe()},{}]}}(e,a.version)))]})))}]}}function Ve(e){let t=m("fas fa-sync","Sync.");return t.state.click$.subscribe((t=>{f.assets.packages.syncPackage$(e).subscribe()})),t}function _e(e){let t=m("fas fa-sync","Sync. all");return t.state.click$.subscribe((t=>{let a={assetIds:Array.from(e.getValue())};f.assets.packages.syncPackages$(a).subscribe()})),t}function Ue(e,t,a){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Version"},{tag:"td",innerText:"Status"}]}]},{tag:"tbody",children:e.reduce(((e,t)=>{let a=t.releases.map((({version:e})=>({assetId:t.assetId,libraryName:t.libraryName,version:e})));return e.concat(a)}),[]).map((({assetId:e,libraryName:n,version:r})=>({tag:"tr",class:"fv-pointer fv-hover-bg-background-alt",children:[{tag:"td",innerText:n},{tag:"td",innerText:r},{tag:"td",children:[{class:(0,s.attr$)(t[e][r],(e=>Ie[e]))},{class:(0,s.attr$)(t[e][r].pipe((0,p.filter)((e=>e!=Re.SYNC)),(0,p.mergeMap)((()=>a))),(t=>t.has(e)?"far fa-clock pl-2":""))}]}]})))}]}}function Ge(e,t,a){return{class:"h-100 w-50 d-flex flex-column fv-bg-background p-3",children:[{tag:"h4",innerText:"Status",class:"text-center"},{class:"flex-grow-1 overflow-auto mt-4",children:[{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Status"},{tag:"td",innerText:"Explorer references"}]}]},{tag:"tbody",children:e.map((e=>{return{tag:"tr",class:"fv-pointer fv-hover-bg-background-alt",children:[{tag:"td",innerText:e.libraryName},(n=a[e.assetId],{tag:"td",class:(0,s.attr$)(n,(({status:e})=>Ie[e]),{untilFirst:"fas fa-spinner fa-spin"})}),{tag:"td",innerText:e.treeItems.length}],onclick:()=>t.next(e)};var n}))}]}]}]}}Re.NOT_FOUND,Re.SYNC,Re.MISMATCH,Re.PROCESSING;class Fe{constructor(){this.libraries$=new r.BehaviorSubject([]),this.librariesStatus$={},this.releasesStatus$={},this.syncQueued$=new r.BehaviorSubject(new Set)}getLibrarie$(){return f.assets.packages.status$().subscribe((({libraries:e})=>{let t=this.syncQueued$.getValue();e.forEach((e=>{this.librariesStatus$[e.assetId]=new r.ReplaySubject,this.releasesStatus$[e.assetId]={},e.treeItems.length>0&&t.add(e.assetId)})),e.reduce(((e,{assetId:t,releases:a})=>e.concat(a.map((({version:e})=>({assetId:t,version:e}))))),[]).map((({assetId:e,version:t})=>{this.releasesStatus$[e][t]=new r.ReplaySubject})),this.libraries$.next(e),this.syncQueued$.next(t)})),this.libraries$}}class Me{constructor(e){this.tag="div",this.class="p-2 fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new r.ReplaySubject,this.state=e,this.children=[(0,s.child$)(this.state.getLibrarie$(),(e=>this.contentView(e)))],this.connectedCallback=e=>{}}contentView(e){return{class:(0,s.attr$)(this.selected$,(()=>"h-50"),{untilFirst:"h-100"}),children:[{class:"d-flex w-100 h-100",children:[Ge(e,this.selected$,this.state.librariesStatus$),(0,s.child$)(this.state.libraries$,(e=>function(e,t,a){return{class:"h-100 w-50 d-flex flex-column fv-bg-background p-3",children:[{class:"d-flex align-items-baseline",children:[{tag:"h4",innerText:"Tasks",class:"text-center px-2"},_e(a)]},{class:"h-100 flex-grow-1 overflow-auto mt-4",children:[Ue(e,t,a)]}]}}(e,this.state.releasesStatus$,this.state.syncQueued$)))]},(0,s.child$)(this.selected$,(e=>{return t=e,a=this.state.librariesStatus$[e.assetId],{class:(0,s.attr$)(a,(({status:e})=>Oe[e]),{untilFirst:"h-100 d-flex flex-column fv-bg-background p-3",wrapper:e=>e+" h-100 d-flex flex-column fv-bg-background p-3"}),style:{"border-width":"3px"},children:[Le(t),Pe(a),{class:"d-flex flex-grow-1",style:{height:"0px"},children:[Ae(t),Be(t,a)]}]};var t,a}))]}}}class je extends n.Tabs.TabData{constructor(e){super("packages","Packages"),this.packagesState=e}view(){return new Me(this.packagesState)}}class qe{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=[new je(e.packagesState)];this.children=[new n.Tabs.View({class:"d-flex flex-column h-100",state:new n.Tabs.State(t),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}class We{constructor(){}}class Ye{constructor(){this.tag="div",this.class=b;let e=new I(q.webSocket$);this.children=[{class:"d-flex flex-column flex-grow-1 w-100 overflow-auto",style:{height:"0"},children:[w({innerHTML:"This is a readonly preview of your current configuration file.\nYou can get arguments completion, type checkings, and more when editing this file with <a href='https://www.jetbrains.com/fr-fr/pycharm/'>pycharm</a> and the plugin <a href='https://pydantic-docs.helpmanual.io/pycharm_plugin/'> pydantic </a>."}),(0,s.child$)(f.environment.fileContent$(),(({content:e})=>({id:"codeMirror",class:"flex-grow-1 w-100 py-1",style:{height:"0"},connectedCallback:t=>{let a=document.getElementById("codeMirror"),s={value:e,mode:"python",theme:"blackboard",lineNumbers:!0};window.CodeMirror(a,s).setSize("100%","100%")}})))]},new P(e)],this.connectedCallback=e=>{e.subscriptions.push()}}}let He={[we.ConfigurationGeneral]:"General",[we.ConfigurationRawFile]:"Raw file"};class ze extends n.Tabs.TabData{constructor(e){super(we.ConfigurationGeneral,He[we.ConfigurationGeneral]),this.generalState=e}view(){return new W(this.generalState)}}class Je extends n.Tabs.TabData{constructor(e){super(we.ConfigurationRawFile,He[we.ConfigurationRawFile]),this.generalState=e}view(){return new Ye}}class Qe{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=[new ze(e.generalState),new Je(e.generalState)];this.children=[new n.Tabs.View({class:"d-flex flex-column h-100",state:new n.Tabs.State(t,e.selectedPanel$),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}a(897);let Ke=new class{constructor(){this.tag="div",this.class="d-flex justify-content-center py-5 px-2 border h-100",this.style={"min-width":"300px"},this.selected$=new r.BehaviorSubject(we.ConfigurationGeneral),this.children=[{class:"h-100 mx-auto d-flex flex-column",children:[{tag:"a",class:"fas fa-home mb-5",href:"/ui/workspace-explorer",innerText:"Explorer",style:{"font-size":"xx-large"}},Se("Environment","fas fa-users-cog my-2",[we.ConfigurationGeneral,we.ConfigurationRawFile],this.selected$),Se("My computer","fas fa-laptop-code my-2",[we.LocalEnvPackage,we.LocalEnvFronts,we.LocalEnvBacks],this.selected$),Se("Upload assets","fas fa-cloud-upload-alt my-2",[],this.selected$,!1),Se("Download assets","fas fa-cloud-download-alt my-2",[],this.selected$,!1)]}]}},Xe=new class{constructor(e){this.selectedPanel$=e,this.logMessages$=new r.Subject,this.modulesState=new K,this.frontendsState=new Y,this.backendsState=new he}}(Ke.selected$),Ze=new class{constructor(e){this.selectedPanel$=e,this.packagesState=new Fe}}(Ke.selected$),et=new class{constructor(e){this.selectedPanel$=e,this.logMessages$=new r.Subject,this.generalState=new q,this.packageState=new We}}(Ke.selected$),tt=Ke.selected$.pipe((0,p.map)((e=>[we.LocalEnvPackage,we.LocalEnvFronts,we.LocalEnvBacks].includes(e)?new Ee(Xe):[we.AssetsUploadPackages].includes(e)?new qe(Ze):[we.ConfigurationGeneral,we.ConfigurationRawFile].includes(e)?new Qe(et):void 0))),at={class:"d-flex fv-text-primary h-100",children:[Ke,(0,s.child$)(tt,(e=>e))]};document.body.appendChild((0,s.render)(at))}}]);
//# sourceMappingURL=435.740f08fb78fb0eb3be21.js.map