#!/usr/bin/env python3

import fire
import json
from pathlib import Path
from snpScore import tableFromVcf


def splitVcf(vcfFile, splitDir, thread=1, sample_prefix=None):
    vcf2tb_obj = tableFromVcf(vcf=vcfFile, out_dir=splitDir, thread=thread, sample_prefix=sample_prefix,
                              out_format='csv')
    vcf2tb_obj.make_table
    return vcf2tb_obj.vcf_samples


def main(vcfFile, splitDir, thread=4, sample_prefix=None):
    splitDir = Path(splitDir)
    vcfDir = splitDir / 'splitVcf'
    vcfDir.mkdir(parents=True, exist_ok=True)
    sample_names = splitVcf(vcfFile, vcfDir, thread, sample_prefix)
    print(json.dumps(sample_names))


if __name__ == "__main__":
    fire.Fire(main)
